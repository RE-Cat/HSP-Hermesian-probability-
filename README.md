# HSP-Hermesian-probability-
HPS 语言完全指南：从零开始学会概率编程

欢迎来到 HPS 的世界！无论你是游戏设计师、数据分析师、概率爱好者，还是单纯对抽卡机制感兴趣的玩家，HPS 都能帮你清晰地表达概率、模拟随机事件、分析统计数据。

本指南将从零开始，一步步带你掌握 HPS 的每一个细节。学完后，你不仅能用 HPS 描述复杂的抽卡池，还能自己设计实验验证概率定律。

---

第一章：HPS 是什么？

HPS 的全称是 HermesProbability Science，一门专门用来处理概率问题的编程语言。

它的设计理念是：

· 极简：用最少的符号表达最丰富的含义。
· 直观：符号形状与含义关联，看一眼就能猜个大概。
· 面向玩家：语法从“我想要什么”出发，而不是从“计算机如何实现”出发。

---

第二章：第一个 HPS 程序

让我们从一个最简单的例子开始：

```
¢ 这是我的第一个 HPS 程序
0.1/
```

· ¢ 是注释符号，后面所有文字都是解释，不会被计算机执行。
· 0.1/ 表示一个概率：0.1%。在 HPS 中，/ 就是概率的标记。

运行这段代码，计算机不会做任何事，只是定义了一个概率值。但我们可以把它赋值给一个变量：

```
#抽卡概率 = 0.1/
```

这里 # 是变量符号，#抽卡概率 就是一个变量，它的值是 0.1%。

---

第三章：基础符号系统

HPS 的所有符号可以分为三类：标识符（代表谁/什么）、操作符（怎么做）、括号（结构化）。

3.1 标识符

符号 名称 含义 示例
@ 玩家符 表示抽卡的主体 @1 表示玩家1
$ 物品符 表示抽卡的目标物品 $1 表示物品1
# 变量符 表示数字或状态 #抽数 表示抽卡次数
¥ 货币符 表示货币或额度 ¥100 表示100元
¢ 元符 注释、输出、函数 ¢,你好 表示输出“你好”

规则：每个标识符只能用于它的领域，不能混用。例如 @池子 是错误的，因为池子要用 #。

3.2 操作符

符号 名称 含义 示例
/ 概率符 标记一个数值为概率 0.1/ 表示0.1%
: 重复符 表示连续操作 0.1/:2 连续两次
- 并行符 表示多人同时 0.1/:2-10 10人各连续两次
⇒ 顺序符 表示然后/导致 抽卡 ⇒ 扣钱
? 条件符 表示如果 ?($1=) ⇒ 停
= 等于符 判断相等 ($1=) 表示物品1已抽到
≠ 不等符 判断不等 ($1≠) 表示物品1没抽到
& 数学符 数学运算 &A(1+2×3) 计算7
! 错误符 错误提示 !语法错误
\ 转义符 输出符号本身 \¢ 输出一个¢字符

3.3 括号

符号 名称 含义 示例
[] 方括号 绑定概率和物品 [0.1/$1]
() 圆括号 定义概率池 (0.1/:$1,$2)
{} 花括号 定义玩家动作 {@1,100}
<> 尖括号 目标声明 <$1,#池子×:10,*90>
"" 引号 储存库 "#数据"

---

第四章：概率的表达

HPS 中最核心的就是概率。你有三种方式表达一个概率：

4.1 基本概率

直接用数字加 / 表示百分比：

```
0.1/      ← 0.1%
50/       ← 50%
100/      ← 100%
```

4.2 科学计数法

对于极大或极小的概率，用 / 后跟 + 或 - 和指数：

```
1/-3      ← 1×10⁻³ = 0.001
1.7/-97   ← 1.7×10⁻⁹⁷
1/+80     ← 1×10⁸⁰（宇宙原子总数）
```

4.3 带系数的科学计数法

如果系数不是1，可以用 a/b/-c 的形式：

```
1.7/1/-97   ← 1.7×1×10⁻⁹⁷ = 1.7×10⁻⁹⁷
2.5/3/+4    ← 2.5×3×10⁴ = 75000
```

---

第五章：物品和池子

抽卡的核心是“从一堆物品中随机抽取一个”。在 HPS 中，我们用 $ 标识物品，用 () 定义池子。

5.1 物品

最简单的物品就是 $1、$2……也可以给物品起名字和属性：

```
$1              ← 物品1
$雷电,5星       ← 名为“雷电”且品质为5星的物品
$甘雨,5星,冰    ← 带多个属性的物品
```

5.2 池子

池子是一组物品，它们共享一个总概率。用 (总概率/:物品列表)#池子名 定义：

```
(0.6/:$雷电,$甘雨)#角色UP
```

含义：创建一个名为“角色UP”的池子，里面有两个物品 $雷电 和 $甘雨，总概率为 0.6%（因此每个物品概率 0.3%）。

也可以定义多个物品：

```
(1/:$1,$2,$3,$4)#四星池
```

5.3 池子的引用

定义好的池子用 #池子名 引用：

```
<#角色UP,:10>   ← 从角色UP池抽10连
```

---

第六章：玩家和动作

谁在抽卡？用 @ 表示玩家，用 {} 表示玩家要执行的动作。

6.1 玩家标识

```
@1    ← 玩家1
@2    ← 玩家2
@0    ← 所有玩家
@1-10 ← 玩家1到10
```

6.2 玩家动作

```
{@1,100} <#角色UP,:1>
```

含义：玩家1执行100次，每次从角色UP池单抽。

也可以在一个动作中执行多条语句：

```
{@1,10}
  <#池子,:1> ⇒ -¥160
  ?($1=) ⇒ ¢,出货！
```

---

第七章：目标声明（HPS 的精髓）

HPS 最强大的特性是目标声明，它让你从玩家视角表达愿望：

```
<$目标物品, #池子 ×:抽卡方式, *保底数>
```

例如：

```
<$雷电,#角色UP×:10,*90>
```

含义：我想要雷电将军，在角色UP池里十连抽，90抽内必得。

其中：

· $雷电 是目标物品
· #角色UP 是池子
· ×:10 表示每次抽10连
· *90 表示保底数为90抽

这个声明会驱动模拟器自动执行抽卡，直到抽到目标或达到保底。

---

第八章：条件控制

用 ? 进行条件判断，用 ⇒ 分隔条件与动作，用 ，否则 表示否则分支。

8.1 基本条件

```
?(#抽数 > 70) ⇒ ¢,软保底触发
```

8.2 条件分支

```
?($雷电=) ⇒ ¢,出货了！，否则 ¢,继续努力
```

8.3 状态判断

($1=) 表示物品1已被抽到，($1≠) 表示未抽到：

```
?($雷电=) ⇒ 停
```

---

第九章：循环

HPS 支持三种循环：while、for、until。

9.1 while 循环

```
while (¥ ≥ 160) {
  <#池子,:1> ⇒ -¥160
}
```

只要钱够就抽。

9.2 for 循环

```
for #i = 1 to 90 {
  <#池子,:1>
}
```

抽90次。

9.3 until 循环

```
until ($雷电=) {
  <#池子,:1>
}
```

一直抽到出雷电。

9.4 特殊循环：#¢{}± 记录循环

```
#¢{ (@1,100) | [0.006/$任意,5星] }± (1000)
```

含义：执行1000次实验，每次让玩家1抽100次，记录每次抽到五星的次数。最后结果存储在 #¢ 变量中，包含 成功、失败、总次数、成功率。

---

第十章：函数

用 ¢.函数名(参数) 定义函数，¢.End 结束。

10.1 无参函数

```
¢.打招呼()
  ¢,你好！
¢.End

打招呼()
```

10.2 带参函数

```
¢.期望(概率)
  return &A(1 ÷ 概率)
¢.End

#雷神期望 = 期望(0.006)
¢,期望抽数：#雷神期望
```

10.3 返回值

函数用 return 返回值。

---

第十一章：经济系统

用 ¥ 表示货币，可以进行加减运算。

11.1 货币值

```
预算 = ¥10000
单价 = ¥160
```

11.2 货币运算

```
预算 - 单价     ← 剩余
预算 ÷ 单价     ← 能抽的次数
```

11.3 货币转换

```
¥R648 → ¥C6480   ← 648人民币换6480结晶
```

11.4 所有货币

$¥ 表示所有货币的总和。

---

第十二章：数学与统计

用 &A() 进行数学运算，遵循先乘除后加减的优先级。

12.1 基础运算

```
&A(1+2×3)        ← 7
&A(10÷2)         ← 5
&A(2^10)         ← 1024
```

12.2 内置函数

函数 含义
㏒(x) 以10为底的对数
㏑(x) 自然对数
√(x) 平方根
sin(x) 正弦
exp(x) e的x次方
avg(a,b,c) 平均值
var(a,b,c) 方差
std(a,b,c) 标准差

12.3 精度控制

用 :数字 保留小数位数：

```
π:5       ← 3.14159
1.7/-97:3 ← 1.700×10⁻⁹⁷
```

---

第十三章：储存库

用 "" 定义存储空间，可以存变量和物品状态。

```
"#历史数据,$1" ← 空
#¢实验{...}± (100)
"#历史数据,$1" ← #¢.成功
```

之后可以读取：

```
#成功次数 = "#历史数据,$1".#历史数据
```

---

第十四章：错误与转义

14.1 错误提示

! 开头的行是错误提示，解释器会自动生成。

14.2 转义

用 \ 让特殊符号变成普通文本：

```
¢,输出 \$1  ← 显示 $1 而不是变量值
```

---

第十五章：完整示例 —— 原神抽卡模拟

现在我们把所有知识结合起来，写一个完整的抽卡模拟器。

```
¢==================================
¢  原神角色UP池抽卡模拟
¢==================================

¢ 1. 定义池子
(0.6/:$雷电,$甘雨,$胡桃)#角色UP

¢ 2. 定义目标
#目标 = $雷电,5星

¢ 3. 初始化
预算 = ¥40000
单价 = ¥160
抽数 = 0
保底计数 = 0

¢ 4. 开始抽卡
{@1, while (预算 ≥ 单价) & (#目标≠)}
  ¢ 单抽一次
  <#角色UP,:1> ⇒ -¥160 ⇒ 抽数++ ⇒ 保底计数++
  
  ¢ 软保底：70抽后概率提升
  ?(保底计数) > 70 ⇒ 
    ¢($任意,5星, ¢0.6 + (保底计数-70)×2)
  
  ¢ 硬保底：90抽必出
  ?(保底计数) = 90 ⇒
    ¢(#目标, ¢100)
  
  ¢ 检查是否出货
  ?($任意,5星=) ⇒ 
    ¢,出五星了！ 
    ?($雷电=) ⇒ ¢,🎉 是雷电！ 停
    ，否则 ¢,歪了... 保底计数重置
    保底计数 = 0

¢ 5. 输出结果
¢,===== 最终报告 =====
¢,目标：?(#目标=) ⇒ "成功" 否则 "失败"
¢,总抽数：#抽数
¢,花费：¥(抽数 × 单价)
¢,剩余预算：¥预算
```

---

第十六章：HPS 能做什么 —— 应用场景

场景 示例
游戏抽卡池设计 用 (概率/:物品) 定义池子，用保底语法设计机制
抽卡策略模拟 用循环和条件模拟不同策略，比较成功率
概率计算 用 &A() 计算期望、方差
数据统计 用 #¢{}± 批量实验，验证大数定律
经济分析 用 ¥ 预算，计算期望花费
教学演示 用 HPS 代码直观展示概率论概念

---

第十七章：语法速查表

标识符

符号 含义
@1 玩家1
$1 物品1
#抽数 变量
¥100 货币
¢ 注释/输出/函数

操作符

符号 含义
/ 概率标记
: 重复
- 并行/减法
⇒ 顺序
? 条件
= 等于
≠ 不等于
& 数学运算
! 错误
\ 转义

括号

符号 用途
[] 绑定概率与物品
() 定义概率池
{} 玩家动作
<> 目标声明
"" 储存库

数学常数

符号 值
π 3.14159...
e 2.71828...
φ 1.61803...
√2 1.41421...

---

第十八章：从零开始的练习

1. 练习1：定义一个池子，里面有3件物品，总概率1%，并输出池子定义成功的消息。
2. 练习2：声明一个目标：想要物品1，用单抽，90抽保底。
3. 练习3：写一个循环，抽到物品2为止，最多抽100次。
4. 练习4：定义一个函数，计算给定概率的期望抽数，并调用它。
5. 练习5：用 #¢{}± 进行1000次实验，每次抽100次，统计出货率。

答案可参考前文示例。

---

第十九章：结语

HPS 是一门为概率而生的语言。从最初的 1.7/-97 到现在的完整体系，我们走过了漫长的创造之旅。现在，它已经准备好帮助更多人理解概率、设计游戏、分析数据。

希望这份指南能让你轻松上手，并在实践中感受到 HPS 的魅力。如果你有任何问题或创意，欢迎继续探索和扩展 HPS 的世界！

---

记住：HPS 不仅是一门语言，更是一种思维方式。